---
description: 依据线索/需求在代码库中收集相关模块，多轮确认后执行 repomix 打包
---

用户调用方式：
- /collect <线索/需求...>
- 后续用户会多轮补充线索、确认/剔除模块
- 用户输入 "OK" 表示进入 repomix 执行阶段

用户输入参数：$ARGUMENTS

## 目标
1) 基于用户线索/需求定位相关模块（文件/目录）
2) 给出候选模块清单：按相关程度 high/middle/low 排序，并给简短依据
3) 维护两个集合（跨轮次记住）：
   - INCLUDE：用户确认要打包的模块
   - IGNORE：用户明确排除的模块
4) 当用户说 "OK"：
   - 生成并执行：repomix --include "<INCLUDE逗号分隔>" --ignore "<IGNORE逗号分隔>"

## 查找策略
- 线索可能是入口文件，也可能是子文件/组件/工具函数：
  - 若是子文件：先找“谁引用/使用了它”（上游引用者），把最相关的 1~3 个引用者当作入口，再继续分析
  - 若能直接定位到页面/路由指向组件：以该组件为入口

- 从入口扩散收集相关模块（最多 2 层）：
  1) 引用链：入口的 import/require/动态 import 直接依赖（以及这些依赖的直接依赖）
  2) 路由链：相关路由配置、菜单/权限配置、以及路由指向组件
  3) 状态链：入口相关的状态模块（pinia / vuex / store / composables）及其 actions/getters 中引用的业务文件
  4) 接口链：状态/组件调用的 api/service/request 文件、以及相关 types/constants

- 反向补全（避免漏模块）：
  - 对 high 相关文件，再检查：它是否被哪些关键入口引用（路由入口/页面组件/store actions），必要时把这些入口也纳入候选

- 去噪：
  - 只收集“被引用到的具体文件”，不整包大目录
  - 通用 utils/全局配置默认 middle/low，除非与线索强相关

## 工作流（核心）
### A. 首轮：从线索生成候选模块
- 从 $ARGUMENTS 提取“入口/关键词/页面/业务名/路径片段/文案/接口”等
- 基于“查找策略”生成候选列表（默认 6~15 条）
- 每条必须包含：
  - 路径（相对仓库根目录，使用 /）
  - 相关程度：high/middle/low
  - 依据：一句话（优先写依赖依据，如“入口文件”“被入口直接 import”“路由指向”“store 引用”“api 被调用”）

### B. 多轮：根据用户反馈收敛
用户可能会：
- “保留/加入”：把某些路径加入 INCLUDE
- “排除”：把某些路径加入 IGNORE
- “补充线索”：你继续扩散/补充候选

你要做的事：
- 每轮都更新：INCLUDE / IGNORE / 候选列表
- 候选列表中，已在 INCLUDE 的标记为 ✅，已在 IGNORE 的标记为 ❌
- 候选列表按相关度排序，并优先展示 high

### C. 终轮：用户输入 OK
当用户消息内容为（大小写不敏感）"OK" 或 "ok"：
1) 如果 INCLUDE 为空：不要执行，提示用户至少确认一个模块
2) 生成命令（路径用 /，用逗号分隔）：
   repomix --include "<include1,include2,...>" --ignore "<ignore1,ignore2,...>"
3) 执行该命令
4) 回显执行结果（成功/失败、关键输出）

## 输出格式（严格遵守）
- 非 OK 阶段：输出三段，且只输出这三段
  1) 候选模块（按 high→middle→low）
  2) 当前 INCLUDE 列表
  3) 当前 IGNORE 列表
- OK 阶段：输出两段
  1) 将要执行的 repomix 命令（bash 代码块）
  2) 命令执行的终端输出（原样）

现在开始：基于用户线索 $ARGUMENTS 生成首轮候选模块清单。
